---
title: Rps10, a molecular barcode with high sensitivity and specificity for oomycetes
output: html_document
---

```{r setup, include=FALSE}
source("style.R")
source("tools.R")
source("configuration.R")
library(metacoder)
library(ape)
library(dplyr)
library(knitr)
library(kableExtra)
```

**OomyceteDB** provides quality-controlled, aligned and annotated Oomycete *rps10* sequences.
*rps10* is a mitochondrial locus chosen as a molecular barcode suitable for metabarcoding or amplicon sequencing specific to the Oomycetes.
The curated database can be downloaded or queried using BLAST (for any release).
We invite all members of the oomycete community to contribute sequences for new Oomycete species.
We will include any new taxon with a GenBank accession you share with us.
The following heat-tree shows the species currently represented in the database:


<!-- <iframe class = "shiny_frame" src="http://oomy.cgrb.oregonstate.edu:3838/grunwald/OomyceteDB_dev/contents" frameBorder="0">
</iframe> -->

```{r cache=FALSE, fig.width=10, fig.height=8, include=FALSE}
seqs <- read.FASTA(get_latest_release_fa())
obj <- names(seqs) %>%
  gsub(pattern = '_', replacement = ' ') %>%
  extract_tax_data(class_sep = ";",
                   regex = "name=(.+)\\|strain=(.+)\\|ncbi acc=(.+)\\|ncbi taxid=(.+)\\|oodb id=(.+)\\|taxonomy=(.+)$",
                   key = c(name = "info", strain = "info", ncbi_acc = "info", ncbi_taxid = "info", oodb_id = "info", taxonomy = "class"))
set.seed(2)
obj %>%
  filter_taxa(taxon_names == "Oomycetes", subtaxa = TRUE) %>%
  remove_redundant_names() %>%
  heat_tree(node_label = taxon_names,
            node_size = n_obs, 
            node_color = n_obs,
            node_size_range = c(0.01, 0.04),
            node_label_size_range = c(0.01, 0.02),
            edge_size_range =  c(0.01, 0.04) * .5,
            layout = "da", initial_layout = "re",
            node_color_axis_label = "Number of sequences")
```

**OomyceteDB** currently includes the following Oomycete taxa:

```{r}
genus_table <- read_csv('genus_count.csv')
  
genus_table <- rbind(genus_table, list("**Total**",
                                       paste0("**", sum(genus_table$`Number of sequences`), "**")))
genus_table %>%
  arrange(desc(genus_table$`Number of sequences`)) %>%
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "center") %>% 
  column_spec(1, italic = T) 
```

